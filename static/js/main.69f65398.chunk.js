(this["webpackJsonptrivia-test"]=this["webpackJsonptrivia-test"]||[]).push([[0],{143:function(e,t,a){e.exports=a(266)},148:function(e,t,a){},153:function(e,t,a){},162:function(e,t){},164:function(e,t){},175:function(e,t){},177:function(e,t){},204:function(e,t){},206:function(e,t){},207:function(e,t){},212:function(e,t){},214:function(e,t){},220:function(e,t){},222:function(e,t){},241:function(e,t){},253:function(e,t){},256:function(e,t){},266:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(50),c=a.n(i),o=(a(148),a(16)),s=a(12),l=a(7),u=a(8),m=a(10),p=a(9),d=(a(153),a(26)),b=a(52),h=a(18),f=a(19),g=a.n(f),v=a(31),E=a(53),y=a.n(E);function k(){return O.apply(this,arguments)}function O(){return(O=Object(v.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api_token.php?command=request");case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a.token);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return w.apply(this,arguments)}function w(){return(w=Object(v.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api.php?amount=5&token=".concat(t));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.results);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=function(e){return{type:"SEND_TOKEN",token:e}};var S=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={email:"",name:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.returnForm=n.returnForm.bind(Object(h.a)(n)),n}return Object(u.a)(a,[{key:"handleChange",value:function(e){var t=e.target;this.setState(Object(b.a)({},t.name,t.value))}},{key:"returnForm",value:function(e,t,a){return r.a.createElement("form",{action:"",className:"login-form"},r.a.createElement("label",{htmlFor:"input-player-name"},"Nome:",r.a.createElement("input",{onChange:this.handleChange,"data-testid":"input-player-name",type:"text",name:"name",value:e,id:"input-player-name"})),r.a.createElement("label",{htmlFor:"input-gravatar-email"},"Email:",r.a.createElement("input",{onChange:this.handleChange,"data-testid":"input-gravatar-email",type:"email",name:"email",value:t,id:"input-gravatar-email"})),r.a.createElement(s.b,{to:"/game"},r.a.createElement("button",{onClick:function(){var n={player:{name:e,assertions:0,score:0,gravatarEmail:t}};localStorage.setItem("state",JSON.stringify(n)),a({name:e,email:t})},"data-testid":"btn-play",type:"button",disabled:!e||!t,id:"play-button"},"Jogar")))}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.email,n=this.props.getToken;return r.a.createElement("div",{id:"login-page"},r.a.createElement("div",{className:"title"},r.a.createElement("h1",null,"Trivia"),r.a.createElement(s.b,{to:"/settings"},r.a.createElement("img",{src:"https://i.ibb.co/kQHXQZt/Pngtree-settings-icon-mechanical-gear-cartoon-4000937.png",alt:""}))),this.returnForm(t,a,n))}}]),a}(n.Component),x=Object(o.b)(null,(function(e){return{getToken:function(t){return e(function(e){var t=e.name,a=e.email;return function(){var e=Object(v.a)(g.a.mark((function e(n){var r,i,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:r=e.sent,i=y()(a).toString(),c="https://www.gravatar.com/avatar/".concat(i),n(N(r)),n({type:"LOG_USER",userInfo:{name:t,email:a,picture:c}}),localStorage.setItem("token",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(t))}}}))(S),I=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{"data-testid":"settings-title"},"Configura\xe7\xf5es"))}}]),a}(n.Component),C=a(54),T=a(22),R=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.timer;return r.a.createElement("div",{className:"timer"},e>0?e:"Acabou o tempo!")}}]),a}(n.Component),A=Object(o.b)((function(e){return{timer:e.timerReducer.timer}}),(function(e){return{updateTimer:function(){return e({type:"UPDATE_TIMER"})}}}))(R),q=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={loading:!0,questions:[],isButtonVisible:!1,shouldDisable:!1,i:0},n.fetchQuest=n.fetchQuest.bind(Object(h.a)(n)),n.returnGame=n.returnGame.bind(Object(h.a)(n)),n.handleClick=n.handleClick.bind(Object(h.a)(n)),n.handleNextQuest=n.handleNextQuest.bind(Object(h.a)(n)),n.verifyAnswer=n.verifyAnswer.bind(Object(h.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.resetTimer;this.fetchQuest(),e()}},{key:"fetchQuest",value:function(){var e=Object(v.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.token,e.next=3,j(t);case 3:a=e.sent,this.setState({questions:a,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"correctAnswer",value:function(){return"correct-answer"}},{key:"verifyAnswer",value:function(e,t){var a=this.props.timer;if(Object.values(e.target.classList).includes(this.correctAnswer())){var n=JSON.parse(localStorage.getItem("state")),r={player:Object(T.a)(Object(T.a)({},n.player),{},{assertions:n.player.assertions+1,score:n.player.score+(10+a*{easy:1,medium:2,hard:3}[t])})};localStorage.setItem("state",JSON.stringify(r))}}},{key:"handleClick",value:function(e){var t=this,a=this.state,n=a.questions,r=a.i,i=e.target.parentNode.children;Object.values(i).forEach((function(e){e.className!==t.correctAnswer()&&"wrong-answer"!==e.className||e.classList.add("".concat(e.className,"-style"))})),this.setState({isButtonVisible:!0,shouldDisable:!0}),this.verifyAnswer(e,n[r].difficulty)}},{key:"retunAnswers",value:function(e,t){return r.a.createElement("div",{className:"answers"},t.sort((function(t,a){return t.key>a.key?1:t.key<a.key?e:0})))}},{key:"handleNextQuest",value:function(){var e=this.props.resetTimer;this.setState((function(e){return{i:e.i+1,isButtonVisible:!1,shouldDisable:!1}})),e()}},{key:"returnNextButton",value:function(){return r.a.createElement("button",{"data-testid":"btn-next",type:"button",onClick:this.handleNextQuest,id:"next-button"},"Pr\xf3xima")}},{key:"mountPage",value:function(e){var t=e.image,a=e.player,n=e.isButtonVisible,i=e.questions,c=e.i,o=e.negative,l=e.answers,u=e.timer;return r.a.createElement("div",{id:"game-page"},r.a.createElement("header",null,r.a.createElement("div",{className:"title"},r.a.createElement("div",{className:"avatar"},r.a.createElement("img",{"data-testid":"header-profile-picture",src:t,alt:"player avatar"}),r.a.createElement("p",{"data-testid":"header-player-name"},a.name)),r.a.createElement("div",null,r.a.createElement(s.b,{to:"/feedback"},"Feedback")))),r.a.createElement("main",{className:"main"},r.a.createElement("section",{className:"status"},r.a.createElement("h3",{"data-testid":"header-score"},"Pontua\xe7\xe3o: ".concat(a.score)),r.a.createElement("div",{className:"timer"},n?"Confira a resposta!":r.a.createElement(A,null))),r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"question-category"},i[c].category),r.a.createElement("h3",{"data-testid":"question-text"},i[c].question)),this.retunAnswers(o,l)),r.a.createElement("div",{className:"button-container"},u<=0||!0===n?this.returnNextButton():null))}},{key:"returnGame",value:function(){var e=this,t=this.state,a=t.questions,n=t.i,i=t.isButtonVisible,c=t.shouldDisable;if(5===n)return r.a.createElement(d.a,{to:"/feedback"});var o=this.props,s=o.image,l=o.timer,u=JSON.parse(localStorage.getItem("state")).player,m=a[n],p=[m.correct_answer].concat(Object(C.a)(m.incorrect_answers)).map((function(t,a){var n=0===a?e.correctAnswer():"wrong-answer-".concat(a-1),i=0===a?e.correctAnswer():"wrong-answer";return r.a.createElement("button",{onClick:e.handleClick,className:i,key:t,type:"button","data-testid":n,disabled:c||l<=0},t)}));return this.mountPage({image:s,player:u,isButtonVisible:i,questions:a,i:n,negative:-1,answers:p,timer:l})}},{key:"render",value:function(){return!0===this.state.loading?r.a.createElement("span",null,"loading..."):this.returnGame()}}]),a}(n.Component),D=Object(o.b)((function(e){return{image:e.loginReducer.picture,questions:e.loginReducer.questions,token:e.loginReducer.token,timer:e.timerReducer.timer}}),(function(e){return{resetTimer:function(){return e({type:"RESET_TIMER"})}}}))(q),J=a(84),_=a.n(J),P=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,a=e.picture,n=JSON.parse(localStorage.getItem("state")).player.score;localStorage.getItem("ranking")||localStorage.setItem("ranking","[]");var r=[].concat(Object(C.a)(JSON.parse(localStorage.getItem("ranking"))),[{name:t,score:n,picture:a}]);localStorage.setItem("ranking",JSON.stringify(r))}},{key:"render",value:function(){var e=this.props.email,t=y()(e).toString(),a=JSON.parse(localStorage.getItem("state")).player,n=r.a.createElement("p",null,"Mandou bem! ".concat(_.a.getUnicode("smile"))),i=r.a.createElement("p",null,"Podia ser melhor... ".concat(_.a.getUnicode("grimacing")));return r.a.createElement("div",{id:"feedback-page"},r.a.createElement("header",null,r.a.createElement("img",{"data-testid":"header-profile-picture",src:"https://www.gravatar.com/avatar/".concat(t),alt:"profile"}),r.a.createElement("h1",{"data-testid":"header-player-name"},a.name)),r.a.createElement("main",null,r.a.createElement("section",null,r.a.createElement("p",null,"Pontua\xe7\xe3o:\xa0",r.a.createElement("span",{"data-testid":"feedback-total-score"},a.score)),r.a.createElement("p",null,"Acertos:\xa0",r.a.createElement("span",{"data-testid":"feedback-total-question"},a.assertions))),r.a.createElement("section",null,r.a.createElement("p",{"data-testid":"feedback-text"},a.assertions>=3?n:i)),r.a.createElement("section",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("button",{"data-testid":"btn-play-again",type:"button"},"Jogar novamente")),r.a.createElement(s.b,{to:"/ranking"},r.a.createElement("button",{"data-testid":"btn-ranking",type:"button"},"Ver ranking")))))}}]),a}(n.Component),Q=Object(o.b)((function(e){return{email:e.loginReducer.email,name:e.loginReducer.name,picture:e.loginReducer.picture}}))(P),B=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("ranking")).sort((function(e,t){return t.score-e.score})).map((function(e,t){return r.a.createElement("li",{key:t,className:"player"},r.a.createElement("p",null,"".concat(t+1,"\xb0")),r.a.createElement("img",{src:e.picture,alt:"Gravatar"}),r.a.createElement("ul",null,r.a.createElement("li",{"data-testid":"player-name-".concat(t)},r.a.createElement("strong",null,"Jogador: "),e.name),r.a.createElement("li",{"data-testid":"player-score-".concat(t)},r.a.createElement("strong",null,"Pontua\xe7\xe3o: "),e.score)))}));return r.a.createElement("div",{id:"ranking-page"},r.a.createElement("div",{className:"title"},r.a.createElement("h1",{"data-testid":"ranking-title"},"Ranking"),r.a.createElement(s.b,{to:"/"},r.a.createElement("button",{type:"button","data-testid":"btn-go-home"},"Home"))),r.a.createElement("ol",null,e))}}]),a}(n.Component),M=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.updateTimer;setInterval((function(){e()}),1e3)}},{key:"render",value:function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:x}),r.a.createElement(d.b,{path:"/settings",component:I}),r.a.createElement(d.b,{path:"/game",component:D}),r.a.createElement(d.b,{path:"/feedback",component:Q}),r.a.createElement(d.b,{path:"/ranking",component:B}))}}]),a}(r.a.Component),U=Object(o.b)(null,(function(e){return{updateTimer:function(){return e({type:"UPDATE_TIMER"})}}}))(M);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F=a(25),G=a(141),V=a(142),L={name:"",email:"",token:""},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOG_USER":return Object(T.a)(Object(T.a)({},e),{},{name:t.userInfo.name,email:t.userInfo.email,picture:t.userInfo.picture});case"SEND_TOKEN":return Object(T.a)(Object(T.a)({},e),{},{token:t.token});case"SEND_QUESTIONS":return Object(T.a)(Object(T.a)({},e),{},{questions:t.questions});default:return e}},H={timer:30},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TIMER":return{timer:e.timer-1};case"RESET_TIMER":return{timer:30};default:return e}},X=Object(F.combineReducers)({loginReducer:W,timerReducer:K}),Z=Object(F.createStore)(X,Object(G.composeWithDevTools)(Object(F.applyMiddleware)(V.a)));c.a.render(r.a.createElement(o.a,{store:Z},r.a.createElement(s.a,null,r.a.createElement(U,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[143,1,2]]]);
//# sourceMappingURL=main.69f65398.chunk.js.map